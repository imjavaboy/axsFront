(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/secondhand-new/Publish"],{"0e50":function(t,e,n){"use strict";var i=n("8555"),a=n.n(i);a.a},1210:function(t,e,n){"use strict";(function(t){n("085c");i(n("66fd"));var e=i(n("6103"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},2901:function(t,e,n){"use strict";n.r(e);var i=n("3f12"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},"3f12":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n("a34a")),a=n("5084");function o(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n,i,a,o,u){try{var l=t[o](u),r=l.value}catch(s){return void n(s)}l.done?e(r):Promise.resolve(r).then(i,a)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function l(t){u(o,i,a,l,r,"next",t)}function r(t){u(o,i,a,l,r,"throw",t)}l(void 0)}))}}var r={name:"Publish",data:function(){return{collapseActiveNames:["1"],fileList:[],urlList:[],photoUrl:"",upCount:0,option1:[{text:"出售",value:0},{text:"求购",value:1},{text:"交换",value:2}],value1:0,option2:[{text:"生活",value:"生活"},{text:"学习",value:"学习"},{text:"穿搭",value:"穿搭"},{text:"其他",value:"其他"}],value2:"生活",isExchange:!1,content:null,type:0,price:null,exchange:null,category:"生活",status:null,itemname:null,isEdit:!1,textValue:""}},methods:{bindTextAreaBlur:function(t){this.textValue=t.detail.value},onCollapseChange:function(t){this.collapseActiveNames=t.detail},onChange:function(t){var e=t.detail;this.type=e,2===this.type?this.isExchange=2:this.isExchange=1},onChangeCatgeory:function(t){var e=t.detail;this.category=e},upImg:function(){for(var e=this,n=0;n<this.fileList.length;n++)(0,a.uploadImge)(this.fileList[n].url).then((function(t){console.log(t),e.urlList.push(t.obj),e.upCount++})).catch((function(e){t.showToast({title:"上传图片失败",icon:"error"})}));console.log(this.urlList)},validateData:function(){return null===this.textValue?(t.showToast({title:"请输入介绍",icon:"error"}),!1):0===this.urlList.length?(t.showToast({title:"请至少上传一张照片",icon:"error"}),!1):2===this.isExchange&&null===this.exchange?(t.showToast({title:"请输入交换物品",icon:"error"}),!1):null===this.status||null===this.itemname?(t.showToast({title:"请输入物品数量",icon:"error"}),!1):2===this.isExchange||null!==this.price||(t.showToast({title:"请输入物品价格",icon:"error"}),!1)},onSubmit:function(){var e=this;return l(i.default.mark((function n(){var o,u,l,r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=[],u=0;case 2:if(!(u<e.fileList.length)){n.next=9;break}return n.next=5,(0,a.uploadImge)(e.fileList[u].url);case 5:o[u]=n.sent;case 6:u++,n.next=2;break;case 9:e.urlList=o.map((function(t){return t.obj})),!0===e.validateData()&&(l=t.getStorageSync("id"),r={uid:l,content:e.textValue,type:e.type,category:e.category,price:e.price,status:e.status,exchange:e.exchange,itemName:e.itemname,photo:e.urlList.join("`")},console.log("发送数据",r),(0,a.insertDealing)(r).then((function(e){200===e.code&&(t.showToast({title:"发布成功",icon:"success"}),t.switchTab({url:"/pages/home/Home"}))})).catch((function(e){t.showToast({title:"发布失败",icon:"error"})})));case 11:case"end":return n.stop()}}),n)})))()},onDeletePicItem:function(t){console.log(t.detail.index,"第几个图片"),this.fileList=this.fileList.splice(t.detail.index,1)},afterRead:function(t){console.log(t.detail,"文件");var e={};e.url=t.detail.file.url,e.name="图片"+(this.fileList.length+1),e.deletable=!0,this.fileList.push(e)}}};e.default=r}).call(this,n("543d")["default"])},"4c92":function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement;t._self._c},o=[]},6103:function(t,e,n){"use strict";n.r(e);var i=n("4c92"),a=n("2901");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("0e50");var u,l=n("f0c5"),r=Object(l["a"])(a["default"],i["b"],i["c"],!1,null,"71edb8da",null,!1,i["a"],u);e["default"]=r.exports},8555:function(t,e,n){}},[["1210","common/runtime","common/vendor"]]]);