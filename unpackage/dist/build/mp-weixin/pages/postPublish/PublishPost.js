(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/postPublish/PublishPost"],{"42a6":function(t,e,n){"use strict";n.r(e);var i=n("b55e"),o=n.n(i);for(var u in i)"default"!==u&&function(t){n.d(e,t,(function(){return i[t]}))}(u);e["default"]=o.a},"7aa3":function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i}));var o=function(){var t=this,e=t.$createElement;t._self._c},u=[]},"920e":function(t,e,n){},9489:function(t,e,n){"use strict";n.r(e);var i=n("7aa3"),o=n("42a6");for(var u in o)"default"!==u&&function(t){n.d(e,t,(function(){return o[t]}))}(u);n("b22e");var a,r=n("f0c5"),c=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"4747b741",null,!1,i["a"],a);e["default"]=c.exports},b22e:function(t,e,n){"use strict";var i=n("920e"),o=n.n(i);o.a},b55e:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(n("a34a")),o=n("5084");function u(t){return t&&t.__esModule?t:{default:t}}function a(t,e,n,i,o,u,a){try{var r=t[u](a),c=r.value}catch(s){return void n(s)}r.done?e(c):Promise.resolve(c).then(i,o)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var u=t.apply(e,n);function r(t){a(u,i,o,r,c,"next",t)}function c(t){a(u,i,o,r,c,"throw",t)}r(void 0)}))}}var c={name:"PublishPost",data:function(){return{textValue:"",fileList:[],urlList:[],upCount:0,option1:[{text:"请选择标签",value:0}],value1:0}},methods:{onLoad:function(){this.getData()},getData:function(){var e=this;(0,o.getAllTags)().then((function(t){console.log("所以标签",t),200===t.code&&t.obj.forEach((function(t){e.option1.push({text:t.tagName,value:t.id})}))})).catch((function(e){t.showToast({title:"获取标签失败",icon:"error"})}))},onChange:function(t){this.value1=t.detail},bindTextAreaBlur:function(t){this.textValue=t.detail.value},afterRead:function(t){console.log(t.detail,"文件");var e={};e.url=t.detail.file.url,e.name="图片"+(this.fileList.length+1),e.deletable=!0,this.fileList.push(e)},onSubmit:function(){var e=this;return r(i.default.mark((function n(){var u,a,r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.showLoading({title:"发布中"}),u=[],a=0;case 3:if(!(a<e.fileList.length)){n.next=10;break}return n.next=6,(0,o.uploadImge)(e.fileList[a].url);case 6:u[a]=n.sent;case 7:a++,n.next=3;break;case 10:e.urlList=u.map((function(t){return t.obj})),r=t.getStorageSync("userInfo"),(0,o.insertPosting)({uid:r.id,content:e.textValue,photo:e.urlList.join("`"),username:r.username,headimg:r.headimg,likesNum:0,commentNum:0,tagsId:e.value1}).then((function(e){200===e.code&&(t.hideLoading(),t.showToast({title:"发布成功",icon:"success"}),console.log("2222222"))})).catch((function(e){t.showToast({title:"发布失败",icon:"success"})})),setTimeout((function(){t.hideLoading()}),1e3),e.upCount=0,e.fileList=[],e.urlList=[],t.switchTab({url:"/pages/forum-home/ForumHome"});case 18:case"end":return n.stop()}}),n)})))()},onDeletePicItem:function(t){console.log(t.detail.index,"第几个图片"),this.fileList=this.fileList.splice(t.detail.index,1)}}};e.default=c}).call(this,n("543d")["default"])},e7e3:function(t,e,n){"use strict";(function(t){n("085c");i(n("66fd"));var e=i(n("9489"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])}},[["e7e3","common/runtime","common/vendor"]]]);